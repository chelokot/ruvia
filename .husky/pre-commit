#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# 1) Bump Android version code in app.json (and local Gradle)
npm run bump:android-version || exit 1

# 2) Run frontend tests (root)
npm test -- --ci || exit 1

# 3) Run backend tests
if [ -d backend ]; then
  if [ -x backend/node_modules/.bin/jest ]; then
    (cd backend && npm test -- --ci) || exit 1
  else
    echo "[husky] Skipping backend tests (install dev deps to enable)"
  fi
fi
